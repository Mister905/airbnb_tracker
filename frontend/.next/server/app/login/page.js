(()=>{var e={};e.id=626,e.ids=[626],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5315:e=>{"use strict";e.exports=require("path")},7360:e=>{"use strict";e.exports=require("url")},1799:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>h,tree:()=>d}),a(4687),a(4752),a(5866);var s=a(3191),r=a(8716),n=a(7922),i=a.n(n),o=a(5231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);a.d(t,l);let d=["",{children:["login",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,4687)),"/Users/james/Desktop/airbnb_tracker/frontend/app/login/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,7481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,4752)),"/Users/james/Desktop/airbnb_tracker/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,5866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,7481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/Users/james/Desktop/airbnb_tracker/frontend/app/login/page.tsx"],u="/login/page",p={require:a,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/login/page",pathname:"/login",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},1029:(e,t,a)=>{Promise.resolve().then(a.bind(a,1442))},3095:(e,t,a)=>{Promise.resolve().then(a.bind(a,783))},8908:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,2994,23)),Promise.resolve().then(a.t.bind(a,6114,23)),Promise.resolve().then(a.t.bind(a,9727,23)),Promise.resolve().then(a.t.bind(a,9671,23)),Promise.resolve().then(a.t.bind(a,1868,23)),Promise.resolve().then(a.t.bind(a,4759,23))},1442:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var s=a(326),r=a(7577),n=a(5047),i=a(6226),o=a(5442),l=a(8962),d=a(1524);function c(){let[e,t]=(0,r.useState)(""),[a,c]=(0,r.useState)(""),[u,p]=(0,r.useState)(!1),[h,m]=(0,r.useState)(null),g=(0,n.useRouter)(),f=(0,l.T)(),b=async t=>{t.preventDefault(),p(!0),m(null);try{let{data:t,error:s}=await o.O.auth.signInWithPassword({email:e,password:a});if(s)throw s;if(t.session)try{let e=new AbortController,a=setTimeout(()=>e.abort(),15e3),s=await fetch("http://localhost:3001/auth/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t.session.access_token}),signal:e.signal});if(clearTimeout(a),!s.ok){let e=await s.text(),t="Failed to verify token with backend";try{let a=JSON.parse(e);t=a.message||a.error||t}catch{t=e||t}throw Error(`${t} (Status: ${s.status})`)}let r=await s.json();f((0,d.av)({user:t.user,supabaseToken:t.session.access_token,backendJwt:r.jwt})),localStorage.setItem("backend_jwt",r.jwt),g.push("/dashboard")}catch(t){let e="Failed to authenticate with backend";t instanceof Error&&(e="AbortError"===t.name?"Request timed out. The backend may be starting up (this can take 30-60 seconds on free tier). Please try again in a moment.":t.message.includes("Failed to fetch")||t.message.includes("NetworkError")||t.message.includes("Network request failed")?"Cannot reach backend at http://localhost:3001. The backend may be starting up or unavailable. Please check that NEXT_PUBLIC_API_URL is correctly set in Vercel.":t.message),console.error("Backend authentication error:",t),m(e)}}catch(e){m((e instanceof Error?e:Error("Failed to login")).message)}finally{p(!1)}};return s.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"var(--color-background)"},children:(0,s.jsxs)("div",{className:"card max-w-md w-full space-y-8 p-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-2",children:[s.jsx(i.default,{src:"/images/Airbnb_Logo.svg",alt:"Airbnb",width:100,height:31,className:"h-8 w-auto",priority:!0}),s.jsx("h2",{className:"text-3xl font-extrabold",style:{color:"var(--color-text-primary)"},children:"Tracker"})]}),s.jsx("p",{className:"mt-2 text-center text-sm",style:{color:"var(--color-text-secondary)"},children:"Sign in to your account"})]}),(0,s.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:b,children:[h&&s.jsx("div",{className:"alert alert-error",children:h}),(0,s.jsxs)("div",{className:"rounded-md shadow-sm -space-y-px",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"email",className:"sr-only",children:"Email address"}),s.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"input appearance-none rounded-none relative block w-full px-3 py-2 rounded-t-md focus:z-10 sm:text-sm",placeholder:"Email address",value:e,onChange:e=>t(e.target.value)})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),s.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"input appearance-none rounded-none relative block w-full px-3 py-2 rounded-b-md focus:z-10 sm:text-sm",placeholder:"Password",value:a,onChange:e=>c(e.target.value)})]})]}),s.jsx("div",{children:s.jsx("button",{type:"submit",disabled:u,className:"btn-primary group relative w-full flex justify-center py-2 px-4 text-sm font-medium rounded-md",children:u?"Signing in...":"Sign in"})})]})]})})}},783:(e,t,a)=>{"use strict";a.d(t,{Providers:()=>c});var s=a(326),r=a(5842),n=a(9718),i=a(5645),o=a(7673),l=a(1524);let d=(0,n.xC)({reducer:{listings:i.ZP,snapshots:o.ZP,auth:l.ZP}});function c({children:e}){return s.jsx(r.zt,{store:d,children:e})}},6824:(e,t,a)=>{"use strict";a.d(t,{h:()=>o});var s=a(5442);let r="http://localhost:3001";async function n(){let e=localStorage.getItem("backend_jwt");if(e)return e;let{data:{session:t}}=await s.O.auth.getSession();if(!t?.access_token)return null;try{let e=await fetch(`${r}/auth/verify`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t.access_token})});if(e.ok){let t=await e.json();if(t.jwt)return localStorage.setItem("backend_jwt",t.jwt),t.jwt}}catch(e){console.error("Failed to exchange token:",e)}return null}async function i(e,t={}){let a=await n(),s={};t.headers&&(t.headers instanceof Headers?t.headers.forEach((e,t)=>{s[t]=e}):Array.isArray(t.headers)?t.headers.forEach(([e,t])=>{s[e]=t}):Object.assign(s,t.headers));let i={"Content-Type":"application/json",...s};a&&(i.Authorization=`Bearer ${a}`);let o=await fetch(`${r}${e}`,{...t,headers:i});if(!o.ok){let e=o.statusText;try{let t=await o.json();e=t.message||t.error||o.statusText}catch{}throw{message:e,statusCode:o.status}}return o}let o={get:async e=>(await i(e)).json(),post:async(e,t)=>(await i(e,{method:"POST",body:JSON.stringify(t)})).json(),patch:async(e,t)=>(await i(e,{method:"PATCH",body:JSON.stringify(t)})).json(),delete:async e=>(await i(e,{method:"DELETE"})).json()}},8962:(e,t,a)=>{"use strict";a.d(t,{C:()=>n,T:()=>r});var s=a(5842);let r=s.I0.withTypes(),n=s.v9.withTypes()},1524:(e,t,a)=>{"use strict";a.d(t,{ZP:()=>i,av:()=>r,pn:()=>n});let s=(0,a(9718).oM)({name:"auth",initialState:{user:null,supabaseToken:null,backendJwt:null,isAuthenticated:!1},reducers:{setUser:(e,t)=>{e.user=t.payload.user,e.supabaseToken=t.payload.supabaseToken,e.backendJwt=t.payload.backendJwt,e.isAuthenticated=!0},clearUser:e=>{e.user=null,e.supabaseToken=null,e.backendJwt=null,e.isAuthenticated=!1}}}),{setUser:r,clearUser:n}=s.actions,i=s.reducer},5645:(e,t,a)=>{"use strict";a.d(t,{Jm:()=>n,ZP:()=>c,b7:()=>l,bw:()=>i});var s=a(9718),r=a(6824);let n=(0,s.hg)("listings/fetchTrackedUrls",async()=>r.h.get("/api/listings/tracked-urls")),i=(0,s.hg)("listings/createTrackedUrl",async e=>r.h.post("/api/listings/tracked-urls",e)),o=(0,s.hg)("listings/updateTrackedUrl",async({id:e,data:t})=>r.h.patch(`/api/listings/tracked-urls/${e}`,t)),l=(0,s.hg)("listings/deleteTrackedUrl",async e=>(await r.h.delete(`/api/listings/tracked-urls/${e}`),e)),d=(0,s.hg)("listings/fetchListings",async({page:e=1,limit:t=50}={})=>r.h.get(`/api/listings?page=${e}&limit=${t}`)),c=(0,s.oM)({name:"listings",initialState:{trackedUrls:[],listings:[],loading:!1,error:null},reducers:{},extraReducers:e=>{e.addCase(n.pending,e=>{e.loading=!0,e.error=null}).addCase(n.fulfilled,(e,t)=>{e.loading=!1,e.trackedUrls=t.payload}).addCase(n.rejected,(e,t)=>{e.loading=!1,e.error=t.error.message||"Failed to fetch tracked URLs"}).addCase(i.fulfilled,(e,t)=>{e.trackedUrls.push(t.payload)}).addCase(o.fulfilled,(e,t)=>{let a=e.trackedUrls.findIndex(e=>e.id===t.payload.id);-1!==a&&(e.trackedUrls[a]=t.payload)}).addCase(l.fulfilled,(e,t)=>{e.trackedUrls=e.trackedUrls.filter(e=>e.id!==t.payload)}).addCase(d.fulfilled,(e,t)=>{e.listings=t.payload.data})}}).reducer},7673:(e,t,a)=>{"use strict";a.d(t,{ZP:()=>d});var s=a(9718),r=a(6824);let n=(0,s.hg)("snapshots/fetchSnapshots",async({listingId:e,page:t=1,limit:a=50,start:s,end:n})=>{let i=new URLSearchParams({listing_id:e,page:t.toString(),limit:a.toString()});return s&&i.append("start",s),n&&i.append("end",n),r.h.get(`/api/snapshots?${i.toString()}`)}),i=(0,s.hg)("snapshots/compareSnapshots",async({fromId:e,toId:t})=>r.h.get(`/api/snapshots/compare/${e}/${t}`)),o=(0,s.oM)({name:"snapshots",initialState:{snapshots:[],comparison:null,loading:!1,error:null},reducers:{clearComparison:e=>{e.comparison=null}},extraReducers:e=>{e.addCase(n.pending,e=>{e.loading=!0,e.error=null}).addCase(n.fulfilled,(e,t)=>{e.loading=!1,e.snapshots=t.payload.data}).addCase(n.rejected,(e,t)=>{e.loading=!1,e.error=t.error.message||"Failed to fetch snapshots"}).addCase(i.fulfilled,(e,t)=>{e.comparison=t.payload})}}),{clearComparison:l}=o.actions,d=o.reducer},5442:(e,t,a)=>{"use strict";a.d(t,{O:()=>i});var s=a(7581);let r="https://pllrzmtdmzogckdzxrki.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBsbHJ6bXRkbXpvZ2NrZHp4cmtpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU3MjUwNDgsImV4cCI6MjA4MTMwMTA0OH0.YXioU81E16L4YbJ2IKmNIJEQIIp8c-lqxCm9Lxabh90";if(!r)throw Error("Missing env.NEXT_PUBLIC_SUPABASE_URL");if(!n)throw Error("Missing env.NEXT_PUBLIC_SUPABASE_ANON_KEY");let i=(0,s.eI)(r,n)},4752:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c,metadata:()=>d});var s=a(9510),r=a(8215),n=a.n(r),i=a(623),o=a.n(i);a(3440);let l=(0,a(8570).createProxy)(String.raw`/Users/james/Desktop/airbnb_tracker/frontend/app/providers.tsx#Providers`),d={title:"Airbnb Tracker",description:"Track and compare Airbnb listing changes"};function c({children:e}){return s.jsx("html",{lang:"en","data-theme":"dark",children:s.jsx("body",{className:`${n().variable} ${o().variable} antialiased`,children:s.jsx(l,{children:e})})})}},4687:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(8570).createProxy)(String.raw`/Users/james/Desktop/airbnb_tracker/frontend/app/login/page.tsx#default`)},7481:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});var s=a(6621);let r=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,s.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},3440:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[948,752,621,224],()=>a(1799));module.exports=s})();